<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Show Times - KSR Cinemas</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <header>
        <nav class="navbar">
            <div class="nav-container">
                <h1 class="logo" id="smartLogo" style="cursor: pointer;">KSR CINEMAS</h1>
                <ul class="nav-menu" id="navMenu">
                    <li><a href="home.html">Home</a></li>
                    <li><a href="movies.html">Movies</a></li>
                    <li><a href="#" id="profileBtn" class="profile-name-btn">Profile</a></li>
                    <li><a href="#" id="logoutBtn">Logout</a></li>
                </ul>
            </div>
        </nav>
    </header>

    <main style="padding: 2rem 0; min-height: 70vh;">
        <div class="container">
            <h1 style="text-align: center; margin-bottom: 2rem; color: #1a1a2e;">Select Show Time</h1>
            
            <!-- Simple Movie Info -->
            <div class="simple-movie-card">
                <h2 id="movie-title">Loading...</h2>
                <p id="movie-info">Loading movie information...</p>
            </div>
            
            <!-- Simple Showtimes -->
            <div class="simple-showtimes">
                <h3>Available Times</h3>
                <div id="times-grid" class="times-grid">
                    <!-- Times will be loaded here -->
                </div>
            </div>
            
            <!-- Selected Show -->
            <div id="selected-show" class="simple-selected" style="display: none;">
                <p id="show-details"></p>
                <a href="seats.html" class="btn btn-primary">Book Tickets</a>
            </div>
        </div>
    </main>

    <footer>
        <div class="container">
            <p>&copy; 2024 KSR Cinemas. All rights reserved.</p>
        </div>
    </footer>

    <script src="js/main.js"></script>
    <script src="js/profile-modal.js"></script>
    <script>
        let currentMovie = null;

        // Load movie data on page load
        document.addEventListener('DOMContentLoaded', async function() {
            await loadMovieData();
        });

        async function loadMovieData() {
            try {
                const urlParams = new URLSearchParams(window.location.search);
                const movieId = urlParams.get('movieId') || '2';
                
                const response = await fetch('./data/movies.json');
                const movies = await response.json();
                
                currentMovie = movies.find(movie => movie.id == movieId);
                
                if (currentMovie) {
                    displaySimpleMovieInfo(currentMovie);
                    displaySimpleShowtimes(currentMovie);
                }
            } catch (error) {
                console.error('Error loading movie data:', error);
            }
        }

        function displaySimpleMovieInfo(movie) {
            document.getElementById('movie-title').textContent = movie.title;
            document.getElementById('movie-info').textContent = 
                `${movie.duration} min • ${movie.genre} • ${movie.rating}`;
        }

        function displaySimpleShowtimes(movie) {
            const container = document.getElementById('times-grid');
            
            if (!movie.showtimes || movie.showtimes.length === 0) {
                container.innerHTML = '<p>No showtimes available</p>';
                return;
            }

            container.innerHTML = movie.showtimes.map(showtime => `
                <button class="time-btn" onclick="selectTime('${showtime.time}', '${showtime.theater}', '${showtime.price}')">
                    <div class="time">${showtime.time}</div>
                    <div class="theater">${showtime.theater}</div>
                    <div class="price">₹${showtime.price}</div>
                </button>
            `).join('');
        }

        function selectTime(time, theater, price) {
            // Remove active from all buttons
            document.querySelectorAll('.time-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Add active to clicked button
            event.target.closest('.time-btn').classList.add('active');
            
            // Show selection
            document.getElementById('show-details').textContent = 
                `${currentMovie.title} • ${time} • ${theater} • ₹${price}`;
            document.getElementById('selected-show').style.display = 'block';
        }
        
        // Logout functionality
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize profile navbar functionality
            initializeProfileNavbar();
        });
    </script>
</body>
</html>